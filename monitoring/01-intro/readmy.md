# Домашнее задание к занятию 13 «Введение в мониторинг»


<details> <summary> ## Обязательные задания </summary>

1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя платформу для вычислений с выдачей текстовых отчётов, которые сохраняются на диск. Взаимодействие с платформой осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы выведите в мониторинг и почему?
2. Менеджер продукта, посмотрев на ваши метрики, сказал, что ему непонятно, что такое RAM/inodes/CPUla. Также он сказал, что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы можете ему предложить?
3. Вашей DevOps-команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики, в свою очередь, хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, чтобы разработчики получали ошибки приложения?
4. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA = 99% по http-кодам ответов. Этот параметр вычисляется по формуле: summ_2xx_requests/summ_all_requests. Он не поднимается выше 70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

</details>

> ### Результат:
>
1. минимальный набор метрик следующий:
- Метрики CPU - при высокой нагрузке на CPU, долго будут выполняются вычисления.
- Метрики дисковой системы - наблюдать за производительностью (iops) и контролировать доступное количество inodes.
- Метрики сетевых интерфейсов - мониторить величину траффика, количество соединений, количество ошибок. 
- Метрики доступности платформы на основе http кодов ответа, их количества и уровень.

2. Предложу настроить мониторинг функциональности продукта, чтобы видно, насколько мы выполняем обязательства: 
- выделить ключевые метрики SLI, сделать дашборды например в Grafana, где вывести значения, динамику соответствия согласованным целям SLO. 
- сделать мониторинг, который покажет насколько продукт соответствует SLO за периоды дающие картины работы продукта, например:  5/15/60 минут, сутки, двое суток, неделю и тд.

3. Решений может быть несколько и выбор каждого из них зависит от того: в каком виде нужны логи приложений, сколько времени их нужно хранить и в каком виде их нужно просматривать.
например:
- Использовать локальные журналы или логи на уровне приложений, правда в этом случае потребуется участие разработчиков, для анализа этих логов и журналов. К томуц же разработчики должны "научить" свои приложения выводить логи в удобном для их чтения виде.
- Выводить показатели работы систем с помощью bash или python скриптов. Также можно использовать стандартные службы, такие как rsyslog.
- Использовать бесплатные системы сбора логов. К примеру Clickhouse + Vector + LightHouse или Elasticsearch + Logstash + Kibana. 

4. В формуле не учтены коды 1xx и 3xx, которые как такоывми не являются ошибками, но summ_all_requests учитывает их как неуспешные запросы, следовательно из за этого и снижается значение SLA.
Корректная формула будет такая:
```bash
(summ_1xx_requests + summ_2xx_requests + summ_3xx_requests)/summ_all_requests
```